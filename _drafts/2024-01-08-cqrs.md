---
layout: post
image: assets/images/system-design/escalabilidade-capa.png
author: matheus
featured: false
published: true
categories: [ system-design, engineering, cloud ]
title: System Design - CQRS
---

# Definindo CQRS

O CQRS, ou **Comand Query Responsability Segregation** é um **padrão arquitetural cujo objetivo é separar as responsabilidades de escrita e leitura de um sistema**. As operações de escrita no padrão do CQRS são denominadas como "comandos", pois entende-se que a implementação de escrita do CQRS seja voltada para efetuar operações imperativas que mudem o estado de uma ou mais entidade do sistema, e as operações de leitura são denominadas como "query", cujo objetivo é apenas fornecer uma capacidade de leitura dos dados desse domínio de forma otimizada. 

O objetivo central do CQRS é **aumentar a performance e a escalabilidade de um serviço através de modelos de dados que sejam especificamente otimizados para suas tarefas**, apostando na teoria de que ao separar as operação de comandos e consultas, cada parte do sistema pode ser escalada independentemente, permitindo uma utilização mais eficiente dos recursos computacionais alocados para cada uma dessas tarefas. 

Se eu pudesse resumir toda a proposta de forma simplista, o padrão se refere basicamente a ter dois ou mais bancos de dados com seus dados replicados, porém com suas  garantindo requisitos especialistas. Iremos abordar essa proposta mediante a outras abordagens um pouco mais complexas poderosas ao decorrer do capítulo. 

## Separacão de Responsabilidades

O princípio central do CQRS é a separação de responsabilidades entre operações de leitura e operações de escrita entre infraestruturas  e modelos de dados diferentes. 

Os **commands** encapsulam todas as informações necessárias para realizar uma operação de escrita, como criar, atualizar ou deletar um registro, além de aplicarem todas as regras de validação necessárias para garantir os níveis de integridade do dado. O modelo de escrita deve focar em garantir a consistência e integridade dos dados. É comum usar bancos de dados relacionais que suportem transações e garantam [ACID (Atomicidade, Consistência, Isolamento, Durabilidade)]() para garantir a consistência e executar as transações de forma atômica. Os bancos de dados de escrita que precisam garantir uma consistência forte contam com processos de normalização para otimizar a performance e integridade. 

As **queries** são responsáveis por **retornar dados sem alterar o estado do sistema**. Os bancos de dados são otimizados para **recuperação rápida e eficiente de informações**, muitas vezes utilizando técnicas como **caching, replicas de leitura ou desnormalização de dados** para melhorar o desempenho para esse tipo de cenário. Bancos de dados NoSQL são frequentemente usados aqui, pois oferecem alta performance em consultas e podem escalar horizontalmente de forma eficaz.

### Modelos de Domínio

### Consistência Eventual no CQRS

### Sincronismo entre modelos

## Microserviços e CQRS



## Monolitos e CQRS

## Event Sourcing e CQRS

### Revisores

* [Tarsila, o amor da minha vida](https://twitter.com/tarsilabianca_c)


<br>

### Referencias

[Centro de Arquitetura Microsoft - Padrão CQRS](https://learn.microsoft.com/pt-br/azure/architecture/patterns/cqrs)

[CQRS – O que é? Onde aplicar?](https://www.eduardopires.net.br/2016/07/cqrs-o-que-e-onde-aplicar/)

[CQRS (Command Query Responsibility Segregation) em uma Arquitetura de Microsserviços](https://medium.com/@marcelomg21/cqrs-command-query-responsibility-segregation-em-uma-arquitetura-de-micro-servi%C3%A7os-71dcb687a8a9)

[Amazon AWS - Padrão CQRS](https://docs.aws.amazon.com/pt_br/prescriptive-guidance/latest/modernization-data-persistence/cqrs-pattern.html)

[Martin Fowler - CQRS](https://www.martinfowler.com/bliki/CQRS.html)

[Gitlab - CQRS](https://ajuda.gitlab.io/guia-rapido/arquitetura/design-patterns/cqrs/)

[Command Query Responsibility Segregation (CQRS)](https://developer.confluent.io/courses/event-sourcing/cqrs/)

[Pattern: Command Query Responsibility Segregation (CQRS)](https://microservices.io/patterns/data/cqrs.html)