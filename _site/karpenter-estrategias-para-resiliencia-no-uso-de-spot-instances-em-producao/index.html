<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="/assets/images/logo.png">

<title>Karpenter — Estratégias para resiliência no uso de Spot Instances em produção | Matheus Fidelis</title>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Karpenter — Estratégias para resiliência no uso de Spot Instances em produção | Matheus Fidelis - Engineering Blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Karpenter — Estratégias para resiliência no uso de Spot Instances em produção" />
<meta name="author" content="matheus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introdução" />
<meta property="og:description" content="Introdução" />
<link rel="canonical" href="https://medium.com/@fidelissauro/karpenter-estrat%C3%A9gias-para-resili%C3%AAncia-no-uso-de-spot-instances-em-produ%C3%A7%C3%A3o-398c7bff2cdc?source=rss-fc2fda5e9bc2------2" />
<meta property="og:url" content="https://medium.com/@fidelissauro/karpenter-estrat%C3%A9gias-para-resili%C3%AAncia-no-uso-de-spot-instances-em-produ%C3%A7%C3%A3o-398c7bff2cdc?source=rss-fc2fda5e9bc2------2" />
<meta property="og:site_name" content="Matheus Fidelis - Engineering Blog" />
<meta property="og:image" content="http://localhost:4000/assets/images/karpenter-spots-vg.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-09T00:00:00-03:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/karpenter-spots-vg.png" />
<meta property="twitter:title" content="Karpenter — Estratégias para resiliência no uso de Spot Instances em produção" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"matheus"},"dateModified":"2022-10-09T00:00:00-03:00","datePublished":"2022-10-09T00:00:00-03:00","description":"Introdução","headline":"Karpenter — Estratégias para resiliência no uso de Spot Instances em produção","image":"http://localhost:4000/assets/images/karpenter-spots-vg.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://medium.com/@fidelissauro/karpenter-estrat%C3%A9gias-para-resili%C3%AAncia-no-uso-de-spot-instances-em-produ%C3%A7%C3%A3o-398c7bff2cdc?source=rss-fc2fda5e9bc2------2"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"},"name":"matheus"},"url":"https://medium.com/@fidelissauro/karpenter-estrat%C3%A9gias-para-resili%C3%AAncia-no-uso-de-spot-instances-em-produ%C3%A7%C3%A3o-398c7bff2cdc?source=rss-fc2fda5e9bc2------2"}</script>
<!-- End Jekyll SEO tag -->


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
<link href="/assets/css/screen.css" rel="stylesheet">

<link href="/assets/css/main.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>

</head>




<body class="layout-post">
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	</noscript>


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">

    <div class="container pr-0">

    <!-- Begin Logo -->
    <a class="navbar-brand" href="/">
    <img src="/assets/images/logo.png" alt="Matheus Fidelis">
    </a>
    <!-- End Logo -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->

            <ul class="navbar-nav ml-auto">

                
                <li class="nav-item">
                
                <a class="nav-link" href="/index.html">Blog</a>
                </li>

                <li class="nav-item">
                <a class="nav-link" href="/about">Sobre</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" target=”_blank” href="/feed.xml">RSS</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" target=”_blank” href="https://fidelissauro.substack.com/">Newsletter</a>
                </li>

                <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>

            </ul>

        <!-- End Menu -->

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">

<div class="container">

<!-- Site Title
================================================== -->
<div class="mainheading">
    <h1 class="sitetitle">Matheus Fidelis</h1>
    <p class="lead">
        Technical Blog
    </p>
</div>

<!-- Content
================================================== -->
<div class="main-content">
    <!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Karpenter — Estratégias para resiliência no uso de Spot Instances em produção&url=http://localhost:4000/karpenter-estrategias-para-resiliencia-no-uso-de-spot-instances-em-producao/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=http://localhost:4000/karpenter-estrategias-para-resiliencia-no-uso-de-spot-instances-em-producao/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/karpenter-estrategias-para-resiliencia-no-uso-de-spot-instances-em-producao/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                
                <div class="row post-top-meta">
                    <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0">
                        
                        <img class="author-thumb" src="https://www.gravatar.com/avatar/5700ede08434f0ab49b75fe5543f129b?s=250&d=mm&r=x" alt="Matheus Fidelis">
                        
                    </div>
                    <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left">
                        <a target="_blank" class="link-dark" href="https://msfidelis.github.io/">Matheus Fidelis</a><a target="_blank" href="https://twitter.com/fidelissauro" class="btn follow">Follow</a>
                        <span class="author-description">Staff Engineer, Lifelong Learner, Site Reliability Engineer, Cloud and Containers Wizard, Software Alchemist and Home Bartender</span>
                    </div>
                </div>
                

                <!-- Post Title -->
                <h1 class="posttitle">Karpenter — Estratégias para resiliência no uso de Spot Instances em produção</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            

            
            <img class="featured-image img-fluid lazyimg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAACCAQAAAA3fa6RAAAADklEQVR42mNkAANGCAUAACMAA2w/AMgAAAAASUVORK5CYII=" data-src="/assets/images/karpenter-spots-vg.png" alt="Karpenter — Estratégias para resiliência no uso de Spot Instances em produção">
            

            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                <!-- End Toc -->
                <h1 class="text-justify" id="introdução">Introdução</h1>

<p><strong>Update 17/11/2023</strong> - <em>Alguns manifestos mudam sua estrutura a partir da versão 0.32.x do Karpenter. Nessa data de hoje aproveitei para atualizar os exemplos para os schemas mais novos. <a href="https://blog.edsoncelio.dev/o-que-muda-no-karpenter-a-partir-das-versoes-032x">Confira o blogpost do Edson sobre o tema</a>.</em></p>

<p>Esse é o segundo artigo que eu publico sobre Karpenter. Dessa vez decidi trazer um ponto de vista bem legal que é a adoção de uso de Spots em produção.</p>

<p>Utilizar spots é uma estratégia muito comum pra quem deseja algum saving na conta da AWS no fim do mês, podem ser utilizada em formas de EC2 diretamente, Containers, Workloads de data e etc.</p>

<p>As instâncias spots nos permitem utilizar capacity ocioso do EC2 na AWS, gerando um saving de até 90% no custo das instâncias comparados aos preços On Demand. Porém a AWS não da uma garantia de que sua instância irá durar para sempre, podendo ser retirada do seu workload a qualquer momento. Por essa questão, o produto é desenhado pra aplicações que rodem no modelo mais stateless possível.</p>

<p>É uma boa pratica ver ambientes de desenvolvimento e teste rodando 100% em spots para diminuir custo, mas ainda existe um certo “receio” em ver ambientes produtivos utilizando toda, ou parte, da sua carga de trabalho em spots. Mas é possível, se utilizarmos de algumas estratégias para isso.</p>

<p>A ideia desse artigo é demonstrar possibilidades do uso do <strong>Karpenter</strong> para ganhar um pouco mais de resiliência em produção em ambientes que rodam totalmente, ou parcialmente com Spots.</p>

<p>Caso você não tenha visto ainda, fiz um artigo sobre uma PoC onde descrevo <strong>como criar um ambiente em Amazon EKS sem Node Groups, utilizando somente o Karpenter pra suprir o capacity computacional</strong>.</p>

<div class="jekyll-linkpreview-wrapper">
  <div class="jekyll-linkpreview-wrapper-inner">
    <div class="jekyll-linkpreview-content">
      <div class="jekyll-linkpreview-image">
        <a href="https://medium.com/@fidelissauro/provisionando-um-cluster-de-eks-sem-node-groups-com-karpenter-4d302b32b620" target="_blank">
          <img src="https://miro.medium.com/v2/resize:fit:1200/0*ZQy5ZyZidbgJThzP.png">
        </a>
      </div>

      <div class="jekyll-linkpreview-body">
        <h2 class="jekyll-linkpreview-title">
          <a href="https://medium.com/@fidelissauro/provisionando-um-cluster-de-eks-sem-node-groups-com-karpenter-4d302b32b620" target="_blank">Provisionando um cluster de EKS sem Node Groups com Karpenter</a>
        </h2>
        <div class="jekyll-linkpreview-description">A proposta dessa PoC é criar e gerenciar um cluster de EKS utilizando apenas (ou quase) o Karpenter como provisionamento de recursos…</div>
      </div>
    </div>
    <div class="jekyll-linkpreview-footer">
      <a href="//medium.com" target="_blank">medium.com</a>
    </div>
  </div>
</div>

<p>Caso você não tenha visto ainda, te convido para ler um artigo que eu escrevi sobre como utilizar o <strong>Istio para sobreviver a cenários de caos</strong>. Não tem nada a ver com o tema, mas eu acho que você vai gostar. #Confia.</p>

<div class="jekyll-linkpreview-wrapper">
  <div class="jekyll-linkpreview-wrapper-inner">
    <div class="jekyll-linkpreview-content">
      <div class="jekyll-linkpreview-image">
        <a href="https://medium.com/@fidelissauro/sobrevivendo-a-cen%C3%A1rios-de-caos-no-kubernetes-com-istio-e-amazon-eks-4fb8469a73da" target="_blank">
          <img src="https://miro.medium.com/v2/resize:fit:1200/0*GkLj74XrpAnGw4Dw.jpeg">
        </a>
      </div>

      <div class="jekyll-linkpreview-body">
        <h2 class="jekyll-linkpreview-title">
          <a href="https://medium.com/@fidelissauro/sobrevivendo-a-cen%C3%A1rios-de-caos-no-kubernetes-com-istio-e-amazon-eks-4fb8469a73da" target="_blank">Sobrevivendo a cenários de caos no Kubernetes com Istio e Amazon EKS</a>
        </h2>
        <div class="jekyll-linkpreview-description">Na sua casa você pode usar o que você quiser, aqui hoje vamos usar Istio. Sem tempo pra chorar irmão…</div>
      </div>
    </div>
    <div class="jekyll-linkpreview-footer">
      <a href="//medium.com" target="_blank">medium.com</a>
    </div>
  </div>
</div>

<p>Todos os exemplos aqui do texto estão feitos de forma resumida, porém você pode encontrá-los de forma completa <a href="https://github.com/msfidelis/eks-karpenter-autonomous-cluster/tree/main/examples/spots">neste repositório do Github</a></p>

<p><a href="https://github.com/msfidelis/eks-karpenter-autonomous-cluster/tree/main/examples/spots">REPOSITÓRIO - eks-karpenter-autonomous-cluster/examples/spots at main · msfidelis/eks-karpenter-autonomous-cluster</a></p>

<p><br></p>

<h2 id="cenário-inicial">Cenário Inicial</h2>

<p>Nesse artigo iremos abordar as estratégias:</p>

<ul>
  <li>Multi-AZ</li>
  <li>Diversificação de Instâncias</li>
  <li>Diversificação entre capacity Spots x On Demand</li>
</ul>

<p>Todos os cenários vão seguir a mesma formula, vamos escalar todos os pods de 2 para 100 e ver como o provisionamento vai se comportar.</p>

<p><br></p>

<h2 id="multi-az">Multi-AZ</h2>

<p>Inicialmente, vamos fazer o básico em relação a ambientes produtivos, sendo ele rodando em spots ou não. Rodar em Multi AZ é o arroz com feijão quando falamos sobre cloud pública no geral. E quando falamos em ambientes 100% spots, onde vamos executar esse primeiro cenário, é praticamente impossível ganhar qualquer tipo de estabilidade sem rodarmos Multi AZ.</p>

<p>Vamos adicionar uma especificação sobre a label <strong><em>topology.kubernetes.io/zone</em></strong> tendo todas as AZ’s que sua aplicação deverá utilizar</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/1e95b30d8c727b0a313d9d6f4f4b9d8a.js"> </script>

<p>Agora vamos realizar uma modificação no nosso deployment utilizando os topology spreads e skews. O controlador do Karpenter vai se basear nessa informação pra realizar o provisionamento dos nodes quando precisar suprir um capacity.</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/025b5c652f656495532e6fb1db78fd8c.js"> </script>

<p><img src="https://cdn-images-1.medium.com/max/1024/1*mceKb3IHQdpQpQSOVCpZOw.png" alt="Imagem"></p>

<p><br></p>

<h3 id="diversificação-de-máquinas">Diversificação de Máquinas</h3>

<p>Uma das estratégias mais efetivas pra se proteger contra compras bruscas de tipos de instancias especificas de spots é a diversificação.</p>

<p>Isso significa subir mais de um tipo de familia e tamanho no workload. Assim, se subirmos um pool de <strong><em>c5.large</em></strong>, <strong><em>m5.large</em></strong> e <strong><em>r5.large</em></strong>, caso exista uma compra massiva de algum desses tamanhos, podemos proteger de forma segura a disponibilidade de nossas aplicações se elas forem distribuídas de forma inteligente entre os nodes.</p>

<p>Primeiramente vamos adicionar/alterar no NodePool a spec baseada na label <strong><em>node.kubernetes.io/instance-type</em></strong> dos nodes, e nela vamos adicionar uma lista contendo os tipos de familia que podem ser lançadas para suprir capacity.</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/26696e26cbb940fc7f714fec6dbd2c91.js"> </script>

<p>Vamos editar o deployment e adicionar o topology spread baseado na label <strong><em>node.kubernetes.io/instance-type</em></strong> também. Dessa forma vamos direcionar uma distribuição do nosso deployment entre os tipos de instancia, assim como fizemos com as AZ’s.</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/6666571baf33473e1378068da17560de.js"> </script>

<p>Vamos fazer o scale do deployment de 2 para 100 pra ver como a distribuição irá ocorrer.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>kubectl scale <span class="nt">--replicas</span> 100 deploy/chip <span class="nt">-n</span> chip
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn-images-1.medium.com/max/1024/1*DJiFbIUwauVltAm1N4yJvg.png" alt="Imagem">
<img src="https://cdn-images-1.medium.com/max/1024/1*MBe1TfXr-4Hqpgl2IOAM0A.png" alt="Imagem"></p>

<p>Dessa forma, conseguimos gerar uma distribuição bem tranquila entre os tamanhos de nodes do cluster pra suprir o novo capacity solicitado conforme o esperado.</p>

<p><br></p>

<h3 id="diversificação-on-demand-x-spots">Diversificação On Demand x Spots</h3>

<p>Uma estratégia mais conservadora e segura de se usar spots em produção baseia-se em fazer uma diversificação entre instancias Spots e On Demand. Mantendo uma porcentagem do workload em extrema segurança. Nesse sentido, o <strong>Karpenter</strong> também nos permite selecionar mais de um tipo de Capacity Type na label <strong><em>karpenter.sh/capacity-type</em></strong>.</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/db03f5dafe0dbfaefb41e8b28e28fcb0.js"> </script>

<p>Agora vamos ajustar o <strong><em>Spread Constraint</em></strong> também como fizemos nos exemplos anteriores para distribuir os pods entre os tipos de nodes (já que agora temos não só o uso de spots, mas também nodes on-demand) assim como fizemos com as AZ’s e os tipos de instâncias.</p>

<noscript><pre>400: Invalid request</pre></noscript>
<script src="https://gist.github.com/5134f9e64efa4e6bc9fc2b0a17bf8ece.js"> </script>

<p>Dessa forma também conseguimos instruir o Karpenter pra subir de forma diversificada a quantidade de Spots vs On Demand.</p>

<p><img src="https://cdn-images-1.medium.com/max/1024/1*7vj9ZVHGhM0rtcLmBsdQ0w.png" alt="Imagem"></p>

<p><br></p>

<h3 id="node-termination-handler---deprecated">Node Termination Handler - <strong>DEPRECATED</strong></h3>

<p>O <strong>Node Termination Handler</strong> é uma forma interessante de fazer Drain dos nossos nodes com base em notificações de Spot Interruptions, Rebalance Recommendations do Autoscale Group ou de um desligamento padrão das EC2. Esses eventos podem ser muito comuns quando tratamos de ambientes voláteis que utilizam estratégias de Spots.</p>

<p><img src="https://cdn-images-1.medium.com/max/995/0*ZgrXumd_2ja6-8QS.png" alt="Imagem"></p>

<p><em>Update 17/11/2023</em> - Segundo a comunidade do Karpenter, não é mais recomendado o uso do Node Termination handler pois o proprio componente agora faz Interruption Handling. - <a href="https://karpenter.sh/docs/faq/#should-i-use-karpenter-interruption-handling-alongside-node-termination-handler">Link</a></p>

<p>A Referencia continuará no post mas os detalhes de implementação serão removidos. Para consulta de referencia, os detalhes de implementação estão <a href="https://github.com/msfidelis/eks-karpenter-autonomous-cluster/blob/note-termination-handler/helm_aws_node_termination_handler.tf">neste link</a></p>

<p>No proximo topico abordaremos o <em>Interruption Handler nativo do Karpenter</em>.</p>

<!-- O **Node Termination Handler** é uma forma interessante de fazer Drain dos nossos nodes com base em notificações de Spot Interruptions, Rebalance Recommendations do Autoscale Group ou de um desligamento padrão das EC2. Esses eventos podem ser muito comuns quando tratamos de ambientes voláteis que utilizam estratégias de Spots.

![Imagem](https://cdn-images-1.medium.com/max/995/0*ZgrXumd_2ja6-8QS.png)

Não vou abordar muitos detalhes do provisionamento, porém vou deixar um [exemplo completo no Github](https://github.com/msfidelis/eks-karpenter-autonomous-cluster).

Mas basicamente, precisamos provisionar o chart do **aws-node-termination-handler**, informando uma URL de um SQS e habilitando o **enableSqsTerminationDraining**. Questões como IAM estão detalhadas no repositório.

<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/f98f1b1373b23df81bc366f1a84a4551.js"> </script>

Precisamos provisionar uma série de Event Rules recomendadas na documentação do projeto e enviá-las para o SQS informado no chart pela **queueURL**.

<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/a928496d90f36656ad2efe49a121db06.js"> </script>

Sempre que um evento de desligamento de Spot for informado, ou solicitado via console, cli, api, um evento será enviado para essa fila SQS, consumido pelo **aws-node-termination-handler** que se encarregará de fazer um drain dos pods a tempo suficiente para realocá-los em outros nodes.

![Imagem](https://cdn-images-1.medium.com/max/865/1*2pvckY_9zzQ61t_yavLf1w.png)

<br> -->

<!-- ### Karpenter - Interruption Handling

*Update 17/11/2023* - Como mencionado no topico anterior, agora o Karpenter possui a feature de realizar handling dos nodes que mudam de estado. 

Para fazer o provisionamento temos que criar a fila SQS da mesma forma como 

<noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/a928496d90f36656ad2efe49a121db06.js"> </script> -->

<h3 id="referências--material-de-apoio">Referências / Material de Apoio</h3>
<ul>
  <li><strong>EKS Best Pratices</strong> <a href="https://aws.github.io/aws-eks-best-practices/karpenter/">https://aws.github.io/aws-eks-best-practices/karpenter/</a></li>
  <li><strong>Pod Topology Spread Constraints</strong> <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/">https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/</a></li>
  <li><strong>Karpenter Provisioner API</strong> <a href="https://karpenter.sh/v0.5.6/provisioner/">https://karpenter.sh/v0.5.6/provisioner/</a></li>
  <li><strong>Karpenter Topology Spread</strong> <a href="https://karpenter.sh/v0.13.2/tasks/scheduling/#topology-spread">https://karpenter.sh/v0.13.2/tasks/scheduling/#topology-spread</a></li>
  <li><strong>EC2 Spot Best Pratices</strong> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-best-practices.html">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-best-practices.html</a></li>
  <li><strong>EC2 Spots</strong> <a href="https://aws.amazon.com/pt/ec2/spot/">https://aws.amazon.com/pt/ec2/spot/</a></li>
  <li><strong>Node Termination Handler</strong> <a href="https://github.com/aws/aws-node-termination-handler">https://github.com/aws/aws-node-termination-handler</a></li>
  <li><strong>Interruption Handling</strong> <a href="https://karpenter.sh/docs/faq/#should-i-use-karpenter-interruption-handling-alongside-node-termination-handler">https://karpenter.sh/docs/faq/#should-i-use-karpenter-interruption-handling-alongside-node-termination-handler</a></li>
  <li><strong>O que muda no Karpenter a partir das versões 0.32.x?</strong> <a href="https://blog.edsoncelio.dev/o-que-muda-no-karpenter-a-partir-das-versoes-032x">https://blog.edsoncelio.dev/o-que-muda-no-karpenter-a-partir-das-versoes-032x</a></li>
</ul>

<p><strong>Obrigado aos revisores:</strong></p>
<ul>
  <li><a href="https://twitter.com/Daniel_Requena">@Daniel_Requena</a></li>
  <li><a href="https://medium.com/u/8b5b07c80a30">Marcos Magalhães</a> (<a href="https://twitter.com/mmagalha">@mmagalha</a>)</li>
  <li><a href="https://medium.com/u/74d7a70cb8c2">Rafael Gomes</a> (<a href="https://twitter.com/gomex">@gomex</a>)</li>
  <li><a href="https://twitter.com/indiepagodeiro">@indiepagodeiro</a></li>
  <li><a href="https://medium.com/u/9a03713671e5">Edson Celio</a> (@tuxpilgrim)</li>
</ul>

<p>Me <a href="https://twitter.com/fidelissauro">sigam no Twitter</a> para acompanhar as paradinhas que eu compartilho por lá!</p>

<p>Te ajudei de alguma forma? Me pague um café (Mentira, todos os valores doados nessa chave são dobrados por mim e destinados a ongs de apoio e resgate animal)</p>

<p><strong>Chave Pix:</strong> fe60fe92-ecba-4165-be5a-3dccf8a06bfc</p>

            </div>

            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2022-10-09">09 Oct 2022</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/categories#arquitetura">arquitetura</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#aws">aws</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#karpenter">karpenter</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#kubernetes">kubernetes</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#terraform">terraform</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="//provisionando-um-cluster-de-eks-sem-node-groups-com-karpenter/"> &laquo; Provisionando um cluster de EKS sem Node Groups com Karpenter</a>
            
            
            <a class="next d-block col-md-6 text-lg-right" href="//argo-rollouts-qual-a-forma-mais-simples-de-executar-canary-releases-e-blue-green-deployments-no/">Argo-Rollouts — "Qual a forma mais simples de executar Canary Releases e Blue/Green Deployments no Kubernetes?" &raquo; </a>
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Begin Comments
================================================== -->

    <div class="container">
        <div id="comments" class="row justify-content-center mb-5">
            <div class="col-md-8">
                <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = ''; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>

            </div>
        </div>
    </div>

<!--End Comments
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

</div>

<!-- 
<!-- Bottom Alert Bar
================================================== -->
<div class="alertbar">
	<div class="container text-center">
		<span><img src="/assets/images/logo.png" alt="Matheus Fidelis - Engineering Blog"> &nbsp; Never miss a <b>story</b> from us, subscribe to our newsletter</span>
        <form action="https://wowthemes.us11.list-manage.com/subscribe/post?u=8aeb20a530e124561927d3bd8&amp;id=8c3d2d214b" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate" target="_blank" novalidate>
            <div class="mc-field-group">
            <input type="email" placeholder="Email" name="EMAIL" class="required email" id="mce-EMAIL" autocomplete="on" required>
            <input type="submit" value="Subscribe" name="subscribe" class="heart">
            </div>
        </form>
	</div>
</div>
 -->
    
</div>

<!-- Categories Jumbotron
================================================== -->
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
            <div class="d-md-flex align-items-center justify-content-center h-100">
                <h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2>
            </div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
            
            
                
                    <a class="mt-1 mb-1" href="/categories#kubernetes">kubernetes (5)</a>
                
                    <a class="mt-1 mb-1" href="/categories#istio">istio (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#disaster-recovery">disaster-recovery (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#service-mesh">service-mesh (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#aws">aws (4)</a>
                
                    <a class="mt-1 mb-1" href="/categories#arquitetura">arquitetura (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#terraform">terraform (4)</a>
                
                    <a class="mt-1 mb-1" href="/categories#karpenter">karpenter (2)</a>
                
                    <a class="mt-1 mb-1" href="/categories#argo-rollouts">argo-rollouts (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#keda">keda (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#containers">containers (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#cloud-native">cloud-native (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#capacity">capacity (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#dicas">dicas (1)</a>
                
            
            
		</div>
	</div>
</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                Copyright © 2023 Matheus Fidelis 
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" href="https://www.wowthemes.net/mediumish-free-jekyll-template/">Mediumish Jekyll Theme</a> by WowThemes.net
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts
================================================== -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="/assets/js/mediumish.js"></script>


<script src="/assets/js/lazyload.js"></script>


<script src="/assets/js/ie10-viewport-bug-workaround.js"></script> 


<script id="dsq-count-scr" src="//.disqus.com/count.js"></script>



<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4Z30K3KNFW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4Z30K3KNFW');
</script>



</body>
</html>
